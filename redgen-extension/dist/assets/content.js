const g=()=>{var e,r;try{const t=document.querySelector('[class*="ArtworkInfo_titleContainer"]'),n=t==null?void 0:t.querySelector('span[class*="styles_display3"]'),l=((e=n==null?void 0:n.textContent)==null?void 0:e.trim())||"",o=t==null?void 0:t.querySelector('span[class*="styles_body"]'),d=((r=o==null?void 0:o.textContent)==null?void 0:r.trim())||"",i=document.querySelector('[data-testid="all-product-tags"]'),p=i==null?void 0:i.querySelectorAll("a"),u=[];p==null||p.forEach(s=>{var f;const a=(f=s.textContent)==null?void 0:f.trim();a&&u.push(a)});const y=[...new Set(u)].join(", "),c=[];if(document.querySelectorAll('[data-testid="product-preview-image"] .swiper-slide img').forEach(s=>{let a=s.currentSrc||s.src;a&&!c.includes(a)&&c.push(a)}),c.length===0){const s=document.querySelector('[class*="ArtworkInfo_imageContainer"] img');s!=null&&s.src&&c.push(s.src)}return{title:l,description:d,tags:y,images:c}}catch(t){return console.error("RedGen Scraper Error:",t),{title:"",description:"",tags:"",images:[]}}},h=e=>{const r=(o,d)=>{var y,c;const i=(y=Object.getOwnPropertyDescriptor(o,"value"))==null?void 0:y.set,p=Object.getPrototypeOf(o),u=(c=Object.getOwnPropertyDescriptor(p,"value"))==null?void 0:c.set;u&&i!==u?u.call(o,d):i?i.call(o,d):o.value=d,o.dispatchEvent(new Event("input",{bubbles:!0})),o.dispatchEvent(new Event("change",{bubbles:!0})),o.dispatchEvent(new Event("blur",{bubbles:!0}))},t=document.querySelector("#work_title_en"),n=document.querySelector("#work_tag_field_en"),l=document.querySelector("#work_description_en");t&&(t.focus(),r(t,e.title)),n&&(n.focus(),r(n,e.tags)),l&&(l.focus(),r(l,e.description))};console.log("ðŸ”´ RedGen Bridge Connected");chrome.runtime.onMessage.addListener((e,r,t)=>{if(e.type==="SCRAPE_PAGE"){const n=g();t({success:!0,data:n})}return e.type==="FILL_FORM"&&(h(e.payload),t({success:!0})),!0});const m=()=>{if(!window.location.pathname.includes("/i/")||document.getElementById("redgen-overlay-btn"))return;const e=document.createElement("button");e.id="redgen-overlay-btn",e.innerText="âž• Add to RedGen",Object.assign(e.style,{position:"fixed",bottom:"20px",right:"20px",zIndex:"9999",backgroundColor:"#ef4444",color:"white",padding:"10px 20px",borderRadius:"50px",border:"none",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",fontSize:"14px",transition:"transform 0.2s"}),e.onmouseover=()=>e.style.transform="scale(1.05)",e.onmouseout=()=>e.style.transform="scale(1)",e.onclick=()=>{const r=g();chrome.runtime.sendMessage({type:"ADD_LISTING_FROM_OVERLAY",payload:r});const t=e.innerText;e.innerText="âœ… Added!",e.style.backgroundColor="#10b981",setTimeout(()=>{e.innerText=t,e.style.backgroundColor="#ef4444"},2e3)},document.body.appendChild(e)};m();let b=location.href;new MutationObserver(()=>{const e=location.href;e!==b&&(b=e,m())}).observe(document,{subtree:!0,childList:!0});
