const x=()=>{var e,n;try{const t=document.querySelector('[class*="ArtworkInfo_titleContainer"]'),o=t==null?void 0:t.querySelector('span[class*="styles_display3"]'),p=((e=o==null?void 0:o.textContent)==null?void 0:e.trim())||"",r=t==null?void 0:t.querySelector('span[class*="styles_body"]'),d=((n=r==null?void 0:r.textContent)==null?void 0:n.trim())||"",a=document.querySelector('[data-testid="all-product-tags"]'),u=a==null?void 0:a.querySelectorAll("a"),i=[];u==null||u.forEach(s=>{var y;const l=(y=s.textContent)==null?void 0:y.trim();l&&i.push(l)});const g=[...new Set(i)].join(", "),c=[];if(document.querySelectorAll('[data-testid="product-preview-image"] .swiper-slide img').forEach(s=>{let l=s.currentSrc||s.src;l&&!c.includes(l)&&c.push(l)}),c.length===0){const s=document.querySelector('[class*="ArtworkInfo_imageContainer"] img');s!=null&&s.src&&c.push(s.src)}return{title:p,description:d,tags:g,images:c}}catch(t){return console.error("RedGen Scraper Error:",t),{title:"",description:"",tags:"",images:[]}}},m=e=>{const n=(r,d)=>{var g,c;const a=(g=Object.getOwnPropertyDescriptor(r,"value"))==null?void 0:g.set,u=Object.getPrototypeOf(r),i=(c=Object.getOwnPropertyDescriptor(u,"value"))==null?void 0:c.set;i&&a!==i?i.call(r,d):a?a.call(r,d):r.value=d,r.dispatchEvent(new Event("input",{bubbles:!0})),r.dispatchEvent(new Event("change",{bubbles:!0})),r.dispatchEvent(new Event("blur",{bubbles:!0}))},t=document.querySelector("#work_title_en"),o=document.querySelector("#work_tag_field_en"),p=document.querySelector("#work_description_en");t&&(t.focus(),n(t,e.title)),o&&(o.focus(),n(o,e.tags)),p&&(p.focus(),n(p,e.description))};console.log("ðŸ”´ RedGen Bridge Connected");chrome.runtime.onMessage.addListener((e,n,t)=>{if(e.type==="SCRAPE_PAGE"){const o=x();t({success:!0,data:o})}return e.type==="FILL_FORM"&&(m(e.payload),t({success:!0})),!0});const f=()=>{if(!window.location.pathname.includes("/i/")||document.getElementById("redgen-overlay-btn"))return;const e=document.createElement("button");e.id="redgen-overlay-btn",e.innerHTML=`
        <span style="font-size: 16px; margin-right: 6px;">ðŸš€</span> 
        <span style="font-weight: 700; letter-spacing: 0.5px;">Add to RedGen</span>
    `,Object.assign(e.style,{position:"fixed",bottom:"24px",right:"24px",zIndex:"2147483647",background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"white",padding:"12px 24px",borderRadius:"9999px",border:"none",cursor:"pointer",boxShadow:"0 10px 15px -3px rgba(220, 38, 38, 0.4), 0 4px 6px -2px rgba(220, 38, 38, 0.2)",fontSize:"14px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",backdropFilter:"blur(4px)"}),e.onmouseover=()=>{e.style.transform="translateY(-2px) scale(1.02)",e.style.boxShadow="0 20px 25px -5px rgba(220, 38, 38, 0.5), 0 10px 10px -5px rgba(220, 38, 38, 0.3)"},e.onmouseout=()=>{e.style.transform="translateY(0) scale(1)",e.style.boxShadow="0 10px 15px -3px rgba(220, 38, 38, 0.4), 0 4px 6px -2px rgba(220, 38, 38, 0.2)"},e.onclick=()=>{const n=x();chrome.runtime.sendMessage({type:"ADD_LISTING_FROM_OVERLAY",payload:n});const t=e.innerHTML,o=e.style.background;e.innerHTML='<span style="font-size: 16px; margin-right: 6px;">âœ…</span> <span style="font-weight: 700;">Added!</span>',e.style.background="linear-gradient(135deg, #10b981 0%, #059669 100%)",e.style.boxShadow="0 10px 15px -3px rgba(5, 150, 105, 0.4)",e.style.transform="scale(0.95)",setTimeout(()=>{e.style.transform="scale(1)"},100),setTimeout(()=>{e.innerHTML=t,e.style.background=o,e.style.boxShadow="0 10px 15px -3px rgba(220, 38, 38, 0.4)"},2e3)},document.body.appendChild(e)};f();let b=location.href;new MutationObserver(()=>{const e=location.href;e!==b&&(b=e,f())}).observe(document,{subtree:!0,childList:!0});
